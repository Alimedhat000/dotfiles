# ========================================
# HYPRLAND CONFIGURATION
# https://wiki.hypr.land/Configuring/
# ========================================

# ========================================
# ENVIRONMENT VARIABLES
# ========================================

# Input Method Framework (fcitx)
env = GTK_IM_MODULE,fcitx
env = QT_IM_MODULE,fcitx
env = XMODIFIERS,@im=fcitx
env = SDL_IM_MODULE,fcitx
env = GLFW_IM_MODULE,ibus

# Qt theming
env = QT_QPA_PLATFORMTHEME,qt6ct

# Font rendering improvements
env = FREETYPE_PROPERTIES,truetype:interpreter-version=40
env = FC_DEBUG,1024

# Electron apps
env = ELECTRON_OZONE_PLATFORM_HINT,auto

env = XDG_MENU_PREFIX,arch-

# ========================================
# NVIDIA-SPECIFIC ENVIRONMENT VARIABLES
# ========================================

# Core NVIDIA settings
env = LIBVA_DRIVER_NAME,nvidia
env = __GLX_VENDOR_LIBRARY_NAME,nvidia
env = XDG_SESSION_TYPE,wayland
env = GBM_BACKEND,nvidia-drm

# Hardware cursor fix (prevents flickering)
env = WLR_NO_HARDWARE_CURSORS,1

# Performance and rendering
env = __GL_GSYNC_ALLOWED,1
env = __GL_VRR_ALLOWED,0
env = WLR_DRM_NO_ATOMIC,1

# CUDA/computation
env = NVD_BACKEND,direct

# ========================================
# MONITOR CONFIGURATION
# ========================================

# Automatic monitor configuration
monitor = ,preferred,auto,auto

# Specific monitor setup (commented out)
# monitor = eDP-2,2560x1600@239.998993,2560x0,1,vrr,1

# ========================================
# STARTUP APPLICATIONS
# ========================================

# Essential system services
exec-once = dbus-update-activation-environment --systemd --all
exec-once = systemctl --user start hyprland-session.target

# Font configuration via gsettings
exec-once = gsettings set org.gnome.desktop.interface font-name 'Inter 10'
exec-once = gsettings set org.gnome.desktop.interface document-font-name 'Source Serif Pro 11'
exec-once = gsettings set org.gnome.desktop.interface monospace-font-name 'Cascadia Code 10'


# ========================================
# INPUT CONFIGURATION
# ========================================

input {
    kb_layout = us,ara
    kb_options = caps:swapescape,grp:shifts_toggle,grp:ralt_rshift_toggle
    numlock_by_default = true
    # Mouse Settigns
    sensitivity = 0.0
    accel_profile= adaptive
}

# ========================================
# GENERAL LAYOUT SETTINGS
# ========================================

general {
    gaps_in = 5
    gaps_out = 5
    border_size = 2
    layout = dwindle
}

# ========================================
# DECORATION SETTINGS
# ========================================

decoration {
    rounding = 12
    
    # Opacity settings
    active_opacity = 0.92
    inactive_opacity = 0.85
    fullscreen_opacity = 1.0
    
    # Shadow settings
    shadow {
        enabled = true
        range = 30
        render_power = 5
        offset = 0 5
        color = rgba(00000070)
    }
}

# ========================================
# ANIMATIONS
# ========================================

animations {
    enabled = true

    animation = windowsIn, 1, 3, default
    animation = windowsOut, 1, 3, default
    animation = windowsMove, 1, 4, default
    animation = workspaces, 1, 5, default
    animation = fade, 1, 3, default
    animation = border, 1, 3, default
}

# ========================================
# LAYOUT-SPECIFIC SETTINGS
# ========================================

# Dwindle layout
dwindle {
    preserve_split = true
}

# Master layout
master {
    mfact = 0.5
}

# ========================================
# MISCELLANEOUS SETTINGS
# ========================================

misc {
    disable_hyprland_logo = true
    disable_splash_rendering = true
    vrr = 1
}

# ========================================
# LAYER RULES
# ========================================


# Vicinae animation disable
layerrule {
    name = vicinae-no-animation
    no_anim = on
    match:namespace = vicinae
}

# Quickshell (DMS) animation disable
layerrule = no_anim on, match:namespace ^(quickshell)$

# ========================================
# WINDOW RULES
# ========================================

# Terminal applications (tiled)
windowrule = tile on, match:class ^(org\.wezfurlong\.wezterm)$

# GNOME applications
windowrule = rounding 12, match:class ^(org\.gnome\.)
windowrule = tile on, match:class ^(gnome-control-center)$
windowrule = float on, match:class ^(org\.gnome\.Nautilus)$

# System utilities (tiled)
windowrule = tile on, match:class ^(pavucontrol)$
windowrule = tile on, match:class ^(nm-connection-editor)$

# Calculators (floating)
windowrule = float on, match:class ^(gnome-calculator)$
windowrule = float on, match:class ^(galculator)$

# System tools (floating)
windowrule = float on, match:class ^(blueman-manager)$
windowrule = float on, match:class ^(xdg-desktop-portal)$

# Applications (floating)
windowrule = float on, match:class ^(steam)$
windowrule = float on, match:class ^(zoom)$

# Firefox Picture-in-Picture
windowrule = float on, match:class ^(firefox)$, match:title ^(Picture-in-Picture)$

# DMS windows (commented - sizing issues)
# windowrule = float on, match:class ^(org.quickshell)$

# ========================================
# EXTERNAL CONFIGURATION FILES
# ========================================

source = ./dms/colors.conf
source = ./dms/outputs.conf
source = ./dms/layout.conf
source = ./dms/cursor.conf
source = ./dms/binds.conf
